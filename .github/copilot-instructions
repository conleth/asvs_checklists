# ğŸ›¡ï¸ Context: AppSec Enablement at Scale â€” **Copilot Authoring Guide**

As the application security lead for a large enterprise (10,000+ developers), I am operationalizing **OWASP ASVSÂ 5.0** across our engineering organisation. This file is injected into **every GitHubÂ Copilot Chat prompt** in this repositoryâ€”follow it faithfully so that the generated Python script and Markdown checkâ€‘lists remain consistent, predictable, and reviewâ€‘ready.

---

## 0Â Â QuickÂ MissionÂ Recap

* **Input**Â Â ASVSÂ 5.0 JSON (`OWASP_Application_Security_Verification_Standard_5.0.0_en.json`).
* **Output**Â A *complete* tree of Markdown checkâ€‘lists:

  ```
  ```

/checklists/{levelN}/{language}/{role}.md

````
Every possible **Level Ã— Language Ã— Role** file must exist, either with mapped controls or the fallback block (Â§â€¯6).
* **Why**Â Â These files gate design reviews, pullâ€‘requests, Securityâ€‘Champion workflows and CI quality checks.

---

## 1Â Â ğŸ¯ Goal (unchanged)
Use the official JSON and generate the checkâ€‘lists exactly as shown. Each file must contain:
1. **Title** â€” `ASVS {LEVEL} Checklist â€“ {LANGUAGE} â€“ {ROLE}`
2. **Header** â€”
 > *Use during DESIGN and PREâ€‘MERGE review. This list is tailored to your stack and responsibility.*
3. **Body** â€” bullet list of mapped ASVS controls *or* the fallback (Â§â€¯6).

---

## 2Â Â ğŸ—‚ï¸ JSON Anatomy (reminder)
Controls live at `.Items[].Items[].Items[]` and expose:
* `Shortcode`Â (e.g. `"V1.2.1"`)
* `Description`Â (full text)
* `L`Â â€“ ASVS level (`"1"`,Â `"2"`,Â `"3"`)

---

## 3Â Â ğŸ§  Role Mapping â€” Keywords & Synonyms
| Role            | PrimaryÂ Keywords | Extra Synonyms Copilot **should** detect |
|-----------------|------------------|------------------------------------------|
| `frontend`      | html, css, react, vue, dom, browser, xss, csp, ui, javascript | csp, serviceâ€‘worker, web storage, localstorage |
| `backend`       | auth, authorization, sql, database, session, crypto, validation, orm | rdbms, jdbc, hibernate, entity, password hash |
| `api`           | rest, graphql, api, endpoint, json, rate limit, payload, websocket | openapi, grpc, webhook, idempotency, throttling |
| `integration`   | oauth, saml, openid, federation, identity, external, idp, sso | oidc, wsâ€‘trust, spâ€‘initiated, idâ€‘token |
| `mobile`        | android, ios, mobile, device, native | keystore, keychain, deeplink, apk, ipa |
| `platform`      | terraform, helm, deployment, cloud, kubernetes, docker, yaml, iac | helmâ€‘chart, k8sâ€‘manifest, cloudâ€‘formation |
| `security`      | encryption, key management, hsm, secure store, jwt, hash, secrets, crypto, kms | key vault, vault, ssl, tls, certificate |
| `data`          | etl, data pipeline, bigquery, s3, data lake, csv, spark, pandas | parquet, warehouse, glue, airflow |
| `devsecops`     | pipeline, scan, sast, dast, dependency, artifact, veracode, semgrep, github actions | trivy, snyk, supplyâ€‘chain, sbom |
| `qa`            | unit test, fuzz, test coverage, selenium, mutation test, e2e | jest, junit, propertyâ€‘based, fuzzing |
| `observability` | logging, trace, telemetry, monitor, alert, correlation, span | opentelemetry, promql, grafana, log injection |
| `devtools`      | sdk, cli, developer experience, internal tool, platform, documentation | apiâ€‘client, codeâ€‘gen, plugin |
| `mlops`         | model, ml, ai, training, serving, onnx, huggingface, model registry | featureâ€‘store, promptâ€‘injection, dataâ€‘poisoning |
| `general`       | *(default if none above match)* | â€” |

> **Heuristic upgrade** â€“ When a control **implicitly** targets a role (e.g., mentions *â€œbrowser cookie SameSiteâ€* â†’ `frontend`) but none of the keywords appear verbatim, Copilot should still assign it to the most obvious role.

---

## 4Â Â ğŸ’» Language Mapping & Security Pitfalls
| Language     | Keywords                                 | Critical Pitfalls & Cues |
|--------------|------------------------------------------|--------------------------|
| `java`       | java, jvm, spring                        | Deserialization (Java serializable), XXE, SSRF with `URLConnection`, JNDI injection (Log4Shell), unchecked `ObjectInputStream`, weak crypto defaults |
| `csharp`     | c#, .net, asp.net                        | ViewState tampering, unsafe `BinaryFormatter`, insecure XML `DataContractSerializer`, certâ€‘validation bypass, CSRF without antiforgery token, insecure cookie flags |
| `python`     | python, flask, django                    | `pickle` / `yaml.load`, flask debug, `subprocess` injection, Django template injection, hardâ€‘coded secrets, deserialization via `PyYAML` |
| `javascript` | javascript, node, typescript, react, vue | Prototype pollution, ReDoS, `eval`/`Function`, DOMâ€‘XSS, insecure JWT libraries, `child_process.exec`, path traversal via `fs` |
| `general`    | *default if none above match*            | Universal issues: input validation, access control, logging, transport security |

**Language Inference Rule** â€” If a controlâ€™s description references any pitfall above, Copilot should tag that control with the corresponding language even if the explicit keyword is missing.

---

## 5Â Â ğŸ“Š Level â†’ Folder Mapping
| Level | Folder   | Inheritance                        |
|-------|----------|------------------------------------|
| 1     | level1   | Appears in **1,Â 2,Â 3**             |
| 2     | level2   | Appears in **2,Â 3**                |
| 3     | level3   | Appears **only** inÂ 3              |

---

## 6Â Â ğŸ†• Mandatory Handling of Empty Checkâ€‘lists
When **no controls match** a `{language}/{role}` slice **still create the file** and insert exactly:
```markdown
> âš ï¸ **No ASVS items map to this language/role.**  
> Review the *General* checklist for Level {LEVEL} and your teamâ€™s secureâ€‘coding guidelines.
````

*Never* omit a file or leave it blank.

---

## 7Â Â ğŸŒ ASVS CategoryÂ â†’ Role/Language Cheatâ€‘Sheet

Copilot can use this table to infer mappings when keywords are sparse:

| ASVS Category (root V\*)     | Likely Roles                         | Likely Languages                         |
| ---------------------------- | ------------------------------------ | ---------------------------------------- |
| V1 Encoding & Injection      | `frontend`, `backend`, `api`         | all                                      |
| V2 Validation & Logic        | `backend`, `api`, `qa`               | all                                      |
| V3 Web Frontend              | `frontend`                           | `javascript`                             |
| V4 API & Web Service         | `api`, `integration`                 | `java`, `csharp`, `python`, `javascript` |
| V5 File Handling             | `backend`, `data`                    | all                                      |
| V6 Authentication            | `backend`, `security`, `integration` | all                                      |
| V7 Session Management        | `backend`, `security`, `frontend`    | all                                      |
| V8 Access Control            | `backend`, `security`                | all                                      |
| V9 Cryptography              | `security`, `backend`                | `java`, `csharp`, `python`               |
| V10 Error Handling & Logging | `backend`, `observability`           | all                                      |
| V11 Data Protection          | `security`, `data`, `mobile`         | all                                      |
| V12 Communications           | `platform`, `security`               | all                                      |
| V13 Malicious Code           | `devsecops`, `platform`              | all                                      |
| V14 Configuration            | `platform`, `devsecops`, `backend`   | all                                      |

*These alignments are nonâ€‘exclusive; Copilot should combine them with keyword and pitfall heuristics.*

---

## 8Â Â ğŸ¤– Agentâ€‘Mode Generation Flow (Copilotâ€‘selfâ€‘check)

1. **Load JSON** (or path passed via `--json`).
2. **Iterate levelsÂ 1â€‘3**.
3. **For each level â†’ each language â†’ each role**:

   1. Collect matching controls (keyword + heuristic tables).
   2. Compose Markdown with title, header, emoji, and either list or fallback block.
   3. Save to the canonical path.
4. Ensure idempotency (clean old files before write or overwrite deterministically).
5. Emit a summary to STDOUT: counts per file, emptyâ€‘file count.

---

## 9Â Â âœ… Output Hygiene

* UTFâ€‘8, Unix newlines, trailing newline.
* Wrap lines â‰¤â€¯120Â chars.
* No trailing whitespace.
* Prefer descriptive commit messages (`feat: generate ASVS checkâ€‘lists`).

---

## ğŸ Bonus (unchanged)

* `<details>` *Defenseâ€‘inâ€‘Depth* section.
* Emoji indicators.
* Rootâ€‘level `README.md` linking to all checkâ€‘lists.

---

## ğŸ§ª Final Task â€” Script Specs (reminder)

Write an **idempotent** PythonÂ 3.11+ script using only stdlib (`json`, `os`, `pathlib`, `collections`, `shutil`). Accept `--json` to override source path.

---

*End of Copilot Authoring Guide (v2 â€“ smarter mapping).*

---

## 10Â Â ğŸ¨ Visual Conventions (emojis)

* **Level badge** â€” At the very top of each checklist file, Copilot must include the levelâ€‘color badge:

  * ğŸŸ¢ **LevelÂ 1**
  * ğŸŸ¡ **LevelÂ 2**
  * ğŸ”´ **LevelÂ 3**
* **Fallback note** â€” When a file has no mapped controls, the placeholder block MUST start with âš ï¸ to draw attention:

  ```markdown
  > âš ï¸ **No ASVS items match this language/role.**  
  > Review the General checklist for Level {LEVEL}.
  ```
* **Chapter separation** â€” Insert ğŸ¯ before each ASVS chapter heading inside the file to make long lists more scannable.

These conventions are mandatory so reviewers can spot level, emptiness, and chapter boundaries at a glance.
